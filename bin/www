#!/usr/bin/env node

// Module dependencies;
const app = require('../app');
const https = require('https');
const path = require('path');
const fs = require('fs')
const { normalizePort, onError, onListening } = require('./config');

// Get port from environment and store in Express;
const port = normalizePort(process.env.PORT || '1337');
app.set('port', port);

// Create HTTP server;
const server = https.createServer(
  {
    key: fs.readFileSync(path.resolve(__dirname, '../server.key'), 'utf8'),
    cert: fs.readFileSync(path.resolve(__dirname, '../server.cert'), 'utf8')
  },
  app
);

// Listen on provided port, on all network interfaces with event listeners and event handlers;
server.listen(port);
server.on('error', onError);
server.on('listening', onListening(server));
